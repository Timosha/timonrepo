--- auto/os/linux.orig	2011-07-19 20:08:17.130007733 +0600
+++ auto/os/linux	2011-07-19 20:12:41.303646098 +0600
@@ -17,8 +17,8 @@
 
 # Linux kernel version
 
-version=$((`uname -r \
-       | sed 's/^\([0-9]*\)\.\([0-9]*\)\.\([0-9]*\).*/\1*256*256+\2*256+\3/'`))
+expression=`uname -r | sed 's/^\([0-9]*\)\.\([0-9]*\)\(\.\([0-9]*\)\)\?.*/\1*256*256+\2*256+\4/'` 
+version=$((${expression%+}))
 
 version=${version:-0}
 
